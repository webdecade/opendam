<?php


/**
 * Skeleton subclass for performing query and update operations on the 'permalink_log' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * jeu. 21 mars 2013 12:25:20 CET
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model
 */
class PermalinkLogPeer extends BasePermalinkLogPeer
{
	const __PERMALINK = 1;
	const __BASKET = 2;
	const __FILE = 3;

	/*________________________________________________________________________________________________________________*/
	public static function isExist($remote_addr)
	{
		$c = new Criteria();
		
		$c->add(self::REMOTE_ADDR, $remote_addr);
		$c->addDescendingOrderByColumn(self::CREATED_AT);

		$log = self::doSelectOne($c);

		if ($log) {
			if ($log->getCreatedAt("U") >= mktime(0,0,0,date("m"),date("d"),date("Y")) 
				&& $log->getCreatedAt("U") <= mktime(23,59,59,date("m"),date("d"),date("Y")))
				return true;
		}

		return false;
	}

	/*________________________________________________________________________________________________________________*/
	public static function addLog($remote_addr, $object_id, $object_type)
	{
		if (!self::isExist($remote_addr)) {
			$log = new PermalinkLog();
			
			$log->setObjectId($object_id);
			$log->setObjectType($object_type);
			$log->setRemoteAddr($remote_addr);

			$log->save();
		}
	}
}
